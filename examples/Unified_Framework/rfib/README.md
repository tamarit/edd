Adaptation from the faulty nofib library for Haskell
